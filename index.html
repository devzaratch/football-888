<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BALLSOD99 | ดูบอลสดฟรี ตารางบอล ผลบอลสด</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <style>
        :root {
            --primary: #ffcc00; /* สีเหลืองทอง DOOBALL99 */
            --bg-body: #0a0b0d;
            --bg-card: #16191e;
            --text-main: #ffffff;
            --text-dim: #a0a0a0;
        }

        body { background-color: var(--bg-body); color: var(--text-main); font-family: 'Kanit', sans-serif; margin: 0; padding: 0; }

        /* Header & Navbar */
        .top-nav { background: #000; border-bottom: 2px solid var(--primary); padding: 10px 0; position: sticky; top: 0; z-index: 1000; }
        .logo-text { font-size: 28px; font-weight: 800; color: #fff; text-decoration: none; }
        .logo-text span { color: var(--primary); }
        .nav-link-custom { color: #fff; text-decoration: none; font-size: 14px; margin: 0 10px; transition: 0.3s; }
        .nav-link-custom:hover { color: var(--primary); }
        .btn-gold { background: var(--primary); color: #000; font-weight: bold; border-radius: 20px; padding: 5px 20px; border: none; }

        /* Banner Zone */
        .banner-zone { width: 100%; max-width: 1000px; margin: 20px auto; border-radius: 10px; overflow: hidden; padding: 0 15px; }
        .banner-zone img { width: 100%; height: auto; border-radius: 10px; }

        .container-main { max-width: 1000px; margin: 0 auto; padding: 0 15px; }

        /* Match Section */
        .section-title { border-left: 4px solid var(--primary); padding-left: 15px; margin-bottom: 20px; font-weight: 700; }
        
        .league-group { background: var(--bg-card); border-radius: 12px; overflow: hidden; margin-bottom: 30px; border: 1px solid rgba(255,255,255,0.05); }
        .league-head { background: #21252b; padding: 12px 20px; font-weight: bold; color: var(--primary); font-size: 15px; }

        .match-item { display: grid; grid-template-columns: 1fr 180px 1fr; align-items: center; padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.03); }
        .match-item:last-child { border-bottom: none; }
        
        .team-box { display: flex; align-items: center; font-size: 15px; }
        .team-home { justify-content: flex-end; text-align: right; }
        .team-away { justify-content: flex-start; text-align: left; }
        .t-logo { width: 35px; height: 35px; object-fit: contain; margin: 0 12px; }

        .status-center { display: flex; flex-direction: column; align-items: center; }
        .time-text { font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 5px; }
        .live-dot { color: var(--primary); font-size: 12px; font-weight: bold; animation: blink 1s infinite; margin-bottom: 5px; }

        /* Buttons */
        .btn-watch { background: var(--primary); color: #000; border: none; border-radius: 5px; font-size: 11px; font-weight: 800; padding: 5px 12px; text-transform: uppercase; width: 110px; transition: 0.2s; text-decoration: none; text-align: center; }
        .btn-watch:hover { background: #fff; transform: scale(1.05); color: #000; }
        .btn-telegram { background: #0088cc; color: #fff; margin-top: 5px; }
        .btn-telegram:hover { background: #00aaff; color: #fff; }
        .btn-wait { background: #2d323a; color: #666; font-size: 11px; padding: 5px 12px; border-radius: 5px; width: 110px; border: none; cursor: not-allowed; }

        /* News Section */
        .news-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .news-card { background: var(--bg-card); border-radius: 8px; overflow: hidden; border: 1px solid rgba(255,255,255,0.05); }
        .news-img { width: 100%; aspect-ratio: 16/9; object-fit: cover; }
        .news-body { padding: 15px; }
        .news-title { font-size: 15px; font-weight: 600; margin-bottom: 8px; color: #eee; }

        @keyframes blink { 50% { opacity: 0.3; } }

        /* Video Overlay */
        .video-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; display: flex; align-items: center; justify-content: center; flex-direction: column; backdrop-filter: blur(8px); }
        .player-wrapper { width: 95%; max-width: 1000px; aspect-ratio: 16/9; background: #000; border-radius: 12px; overflow: hidden; position: relative; border: 1px solid #333; }
        .close-btn { position: absolute; top: 15px; right: 15px; background: var(--primary); color: #000; border: none; border-radius: 50%; width: 35px; height: 35px; cursor: pointer; z-index: 10; font-weight: bold; }

        @media (max-width: 600px) {
            .match-item { grid-template-columns: 1fr 120px 1fr; padding: 10px 5px; }
            .team-box { flex-direction: column; font-size: 12px; text-align: center; }
            .team-home { justify-content: center; }
            .t-logo { width: 28px; height: 28px; margin: 5px 0; }
            .btn-watch { width: 95px; font-size: 9px; }
        }
    </style>
</head>
<body>

<nav class="top-nav">
    <div class="container d-flex justify-content-between align-items-center">
        <a href="#" class="logo-text">BALLSOD<span>99</span></a>
        <div class="d-none d-md-block">
            <a href="#" class="nav-link-custom">ดูบอลสด</a>
            <a href="#" class="nav-link-custom">ตารางบอล</a>
            <a href="#" class="nav-link-custom">ผลบอลสด</a>
            <button class="btn-gold ms-3">ทางเข้าหลัก</button>
        </div>
    </div>
</nav>

<div class="banner-zone">
    <img src="https://boengnang.com/wp-content/uploads/2025/12/UFA.gif" alt="Banner">
</div>

<div class="container-main">
    <h4 class="section-title"><i class="bi bi-broadcast text-warning"></i> รายการถ่ายทอดสด</h4>
    
    <div id="match-list">
        <div class="text-center py-5">
            <div class="spinner-border text-warning" role="status"></div>
            <p class="mt-3 text-secondary">กำลังดึงข้อมูลคู่แข่งขัน...</p>
        </div>
    </div>

    <h4 class="section-title mt-5"><i class="bi bi-newspaper text-warning"></i> ข่าวสารฟุตบอล</h4>
    <div class="news-grid">
        <div class="news-card">
            <img src="https://via.placeholder.com/400x225/222/fff?text=News+1" class="news-img">
            <div class="news-body"><div class="news-title">วิเคราะห์พรีเมียร์ลีกคืนนี้ คู่บิ๊กแมตช์ที่ทุกคนรอคอย</div></div>
        </div>
        <div class="news-card">
            <img src="https://via.placeholder.com/400x225/222/fff?text=News+2" class="news-img">
            <div class="news-body"><div class="news-title">สรุปตลาดซื้อขายนักเตะล่าสุด ทีมไหนเสริมทัพโหดที่สุด</div></div>
        </div>
    </div>
    
    <div class="text-center py-5 opacity-25">
        <p>© 2026 DOOBALL99 - แหล่งรวมลิ้งค์ดูบอลสดที่ดีที่สุด</p>
    </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyA_w7ZMYOx_eVqcFZ2EWrc2pn4QOIe4Ekg",
    authDomain: "football-888-b9a7e.firebaseapp.com",
    databaseURL: "https://football-888-b9a7e-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "football-888-b9a7e",
    storageBucket: "football-888-b9a7e.firebasestorage.app",
    messagingSenderId: "354132820390",
    appId: "1:354132820390:web:69b68bc56a506a7ed0cf67",
    measurementId: "G-RDZFSLYB30"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  let hlsInstance = null;

  // ฟังก์ชันเปิดเครื่องเล่น
  window.watchMatch = function(matchId, link1, embedUrl, isM3u8) {
    const content = embedUrl && (isM3u8 || embedUrl.includes('.m3u8')) 
        ? `<video id="hls-player" controls autoplay style="width:100%;height:100%;"></video>`
        : `<iframe src="${embedUrl}" style="width:100%;height:100%;border:0;" allowfullscreen></iframe>`;

    const overlay = document.createElement('div');
    overlay.className = 'video-overlay';
    overlay.innerHTML = `<div class="player-wrapper"><button class="close-btn" onclick="closePlayer()">✕</button>${content}</div>`;
    document.body.appendChild(overlay);

    if (embedUrl && (isM3u8 || embedUrl.includes('.m3u8')) && Hls.isSupported()) {
        const video = document.getElementById('hls-player');
        hlsInstance = new Hls();
        hlsInstance.loadSource(embedUrl);
        hlsInstance.attachMedia(video);
    }
  }

  window.closePlayer = function() {
      const overlay = document.querySelector('.video-overlay');
      if(overlay) overlay.remove();
      if(hlsInstance) hlsInstance.destroy();
  }

  // ดึงข้อมูล Realtime
  const matchesRef = ref(db, 'matches');
  onValue(matchesRef, (snapshot) => {
    const data = snapshot.val();
    const listDiv = document.getElementById('match-list');
    listDiv.innerHTML = "";

    if (data) {
        const groups = {};
        Object.keys(data).forEach(key => {
            const m = data[key];
            const league = m.league || "รายการแข่งขัน";
            if (!groups[league]) groups[league] = [];
            groups[league].push({...m, key});
        });

        Object.keys(groups).forEach(leagueName => {
            let html = `<div class="league-group"><div class="league-head"><i class="bi bi-trophy-fill me-2"></i> ${leagueName}</div>`;
            groups[leagueName].forEach(m => {
                const isLive = m.is_live || m.time.toLowerCase().includes('live');
                const isM3u8 = m.is_m3u8 || (m.embed_url && m.embed_url.includes('.m3u8'));
                
                // ระบบปุ่มรับชมและปุ่ม Telegram
                let actionHtml = "";
                if (isLive) {
                    actionHtml += `<button class="btn-watch" onclick="watchMatch('${m.key}', '${m.links?.link1 || ''}', '${m.embed_url}', ${isM3u8})">รับชมสด</button>`;
                    if (m.links && m.links.telegram) {
                        actionHtml += `<a href="${m.links.telegram}" target="_blank" class="btn-watch btn-telegram"><i class="bi bi-telegram"></i> สำรอง</a>`;
                    }
                } else {
                    actionHtml = `<button class="btn-wait" disabled>รอแข่งขัน</button>`;
                }

                html += `
                    <div class="match-item">
                        <div class="team-box team-home"><span>${m.home}</span><img src="${m.home_logo}" class="t-logo" onerror="this.src='https://via.placeholder.com/35'"></div>
                        <div class="status-center">
                            ${isLive ? '<div class="live-dot">● LIVE</div>' : `<div class="time-text">${m.time}</div>`}
                            <div class="d-flex flex-column gap-1">${actionHtml}</div>
                        </div>
                        <div class="team-box team-away"><img src="${m.away_logo}" class="t-logo" onerror="this.src='https://via.placeholder.com/35'"><span>${m.away}</span></div>
                    </div>`;
            });
            html += `</div>`;
            listDiv.innerHTML += html;
        });
    }
  });
</script>

</body>
</html>
